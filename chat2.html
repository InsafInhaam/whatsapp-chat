<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>WhatsApp Commerce Automation Demo</title>

<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>

<style>
.typing span { animation: blink 1.4s infinite both; }
.typing span:nth-child(2){animation-delay:.2s}
.typing span:nth-child(3){animation-delay:.4s}
@keyframes blink {0%{opacity:.2}20%{opacity:1}100%{opacity:.2}}

.island-expand { width:260px !important; }

/* fake keyboard typing */
.cursor::after {
  content: "|";
  animation: blink 1s infinite;
}
</style>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">

<div class="relative w-[390px] h-[800px] bg-black rounded-[3.5rem] p-[10px] shadow-2xl">

  <!-- Dynamic Island -->
  <div id="island"
    class="absolute top-4 left-1/2 -translate-x-1/2 z-50
    bg-black text-white h-7 w-32 rounded-full
    flex items-center justify-center gap-2 text-xs transition-all duration-300">
    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Store Bot
  </div>

  <div class="relative w-full h-full bg-[#e5ddd5] rounded-[3rem] overflow-hidden flex flex-col">

    <!-- Header -->
    <div class="bg-[#075e54] pt-10 p-4 flex items-center gap-3 text-white">
      <span class="material-symbols-outlined">arrow_back</span>
      <div class="size-8 rounded-full bg-white/20 flex items-center justify-center">
        <span class="material-symbols-outlined text-sm">shopping_bag</span>
      </div>
      <div>
        <p class="text-sm font-bold">UrbanStyle Store</p>
        <p class="text-xs opacity-80">Online</p>
      </div>
    </div>

    <!-- Chat -->
    <div id="chat" class="flex-1 p-4 flex flex-col gap-4 overflow-y-auto text-sm"></div>

    <!-- Input -->
    <div id="inputBar" class="p-2 bg-[#f0f0f0] flex items-center gap-2">
      <div id="inputText" class="flex-1 bg-white h-10 rounded-full px-4 flex items-center text-gray-600 cursor"></div>
      <div class="size-10 bg-[#075e54] rounded-full flex items-center justify-center text-white">
        <span class="material-symbols-outlined">send</span>
      </div>
    </div>
  </div>
</div>

<script>
const chat = document.getElementById("chat");
const island = document.getElementById("island");
const inputText = document.getElementById("inputText");

/* UTILITIES */
function scroll() { chat.scrollTop = chat.scrollHeight; }

function islandExpand(text) {
  island.classList.add("island-expand");
  island.innerHTML = `<span class="material-symbols-outlined text-sm">shopping_bag</span>${text}`;
}
function islandReset() {
  island.classList.remove("island-expand");
  island.innerHTML = `<span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Store Bot`;
}

function typingBubble() {
  const t=document.createElement("div");
  t.id="typing";
  t.className="self-start bg-white p-3 rounded-lg shadow-sm";
  t.innerHTML=`<div class="typing flex gap-1"><span>â€¢</span><span>â€¢</span><span>â€¢</span></div>`;
  chat.appendChild(t); scroll();
}
function stopTyping(){const t=document.getElementById("typing");if(t)t.remove();}

function msg(text, side="start") {
  const m=document.createElement("div");
  m.className=`self-${side} ${side==="end"?"bg-[#dcf8c6] rounded-tr-none":"bg-white rounded-tl-none"} p-3 rounded-lg shadow-sm max-w-[85%]`;
  m.innerText=text;
  chat.appendChild(m); scroll();
}

/* KEYBOARD TYPING EFFECT */
function typeUserMessage(text, cb) {
  inputText.innerText="";
  let i=0;
  const interval=setInterval(()=>{
    inputText.innerText += text[i];
    i++;
    if(i===text.length){
      clearInterval(interval);
      setTimeout(()=>{
        msg(text,"end");
        inputText.innerText="";
        cb && cb();
      },500);
    }
  },60);
}

/* VARIANT BUTTONS */
function variantButtons() {
  const box=document.createElement("div");
  box.className="self-start bg-white p-3 rounded-lg shadow-sm max-w-[85%]";
  box.innerHTML=`
    <p class="mb-2">Select size:</p>
    <div class="flex gap-2">
      <button class="px-3 py-1 bg-gray-200 rounded">S</button>
      <button class="px-3 py-1 bg-gray-200 rounded">M</button>
      <button class="px-3 py-1 bg-gray-200 rounded">L</button>
    </div>`;
  chat.appendChild(box); scroll();
}

/* PRODUCT CAROUSEL */
function productCarousel() {
  const c=document.createElement("div");
  c.className="self-start bg-white p-2 rounded-lg shadow-sm max-w-[85%]";
  c.innerHTML=`
    <div class="flex gap-2 overflow-x-auto">
      <img class="h-32 rounded" src="https://images.unsplash.com/photo-1523381210434-271e8be1f52b">
      <img class="h-32 rounded" src="https://images.unsplash.com/photo-1541099649105-f69ad21f3246">
      <img class="h-32 rounded" src="https://images.unsplash.com/photo-1526170375885-4d8ecf77b99f">
    </div>
    <p class="mt-2">More styles you may like</p>`;
  chat.appendChild(c); scroll();
}

/* DEMO FLOW */
function startDemo(){
  chat.innerHTML=""; islandReset();

  setTimeout(()=>typeUserMessage("Hi, do you have hoodies?", ()=>{
    typingBubble();
  }),800);

  setTimeout(()=>{
    stopTyping();
    islandExpand("Browsing catalog");
    msg("Yes! Here are some popular hoodies ðŸ‘‡");
    productCarousel();
    islandReset();
  },2600);

  setTimeout(()=>typeUserMessage("I like the first one", ()=>{
    typingBubble();
  }),4200);

  setTimeout(()=>{
    stopTyping();
    msg("Great choice! Please select your size:");
    variantButtons();
  },6200);

  setTimeout(()=>typeUserMessage("Size M", ()=>{
    typingBubble();
  }),8200);

  setTimeout(()=>{
    stopTyping();
    msg("Perfect ðŸ‘ Price is LKR 6,500. Cash on Delivery available. Please share delivery address.");
  },10200);

  setTimeout(()=>typeUserMessage("No 12, Galle Road, Colombo", ()=>{
    typingBubble();
  }),12200);

  setTimeout(()=>{
    stopTyping();
    islandExpand("Order confirmed");
    msg("âœ… Order Confirmed!\nHoodie (Size M)\nDelivery: Colombo\nPayment: COD\n\nThank you for shopping with us!");
    islandReset();
  },14600);

  /* Abandoned Cart Follow-up */
  setTimeout(()=>{
    typingBubble();
  },17500);

  setTimeout(()=>{
    stopTyping();
    islandExpand("Follow-up");
    msg("Hi ðŸ‘‹ Just checking â€” your hoodie is still available. Would you like to place another order?");
    islandReset();
  },19500);

  setTimeout(startDemo,23000);
}

startDemo();
</script>

</body>
</html>
