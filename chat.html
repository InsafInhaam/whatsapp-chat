<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>WhatsApp E-commerce Demo</title>

<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>

<style>
.typing span {
  animation: blink 1.4s infinite both;
}
.typing span:nth-child(2){animation-delay:.2s}
.typing span:nth-child(3){animation-delay:.4s}
@keyframes blink {
  0%{opacity:.2} 20%{opacity:1} 100%{opacity:.2}
}
.island-expand {
  width: 240px !important;
}
</style>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">

<div class="relative w-[390px] h-[800px] bg-black rounded-[3.5rem] p-[10px] shadow-2xl">

  <!-- Dynamic Island -->
  <div id="island"
    class="absolute top-4 left-1/2 -translate-x-1/2 z-50
           bg-black text-white h-7 w-32 rounded-full
           flex items-center justify-center gap-2 text-xs
           transition-all duration-300">
    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
    Store Bot
  </div>

  <!-- Screen -->
  <div class="relative w-full h-full bg-[#e5ddd5] rounded-[3rem] overflow-hidden flex flex-col">

    <!-- Header -->
    <div class="bg-[#075e54] pt-10 p-4 flex items-center gap-3 text-white">
      <span class="material-symbols-outlined">arrow_back</span>
      <div class="size-8 rounded-full bg-white/20 flex items-center justify-center">
        <span class="material-symbols-outlined text-sm">shopping_bag</span>
      </div>
      <div>
        <p class="text-sm font-bold">UrbanStyle Store</p>
        <p class="text-xs opacity-80">Typically replies instantly</p>
      </div>
    </div>

    <!-- Chat -->
    <div id="chat" class="flex-1 p-4 flex flex-col gap-4 overflow-y-auto text-sm"></div>

    <!-- Input -->
    <div class="p-2 bg-[#f0f0f0] flex items-center gap-2 pb-5">
      <div class="flex-1 bg-white h-10 rounded-full px-4 flex items-center text-gray-400">
        Type a message...
      </div>
      <div class="size-10 bg-[#075e54] rounded-full flex items-center justify-center text-white">
        <span class="material-symbols-outlined">send</span>
      </div>
    </div>
  </div>
</div>

<script>
const chat = document.getElementById("chat");
const island = document.getElementById("island");

function addMessage(text, side) {
  const msg = document.createElement("div");
  msg.className = `
    self-${side}
    ${side==="end"?"bg-[#dcf8c6] rounded-tr-none":"bg-white rounded-tl-none"}
    p-3 rounded-lg shadow-sm max-w-[85%]
  `;
  msg.innerText = text;
  chat.appendChild(msg);
  chat.scrollTop = chat.scrollHeight;
}

function addImageMessage(side) {
  const box = document.createElement("div");
  box.className = `
    self-${side}
    bg-white p-2 rounded-lg shadow-sm max-w-[85%]
  `;
  box.innerHTML = `
    <div class="h-40 rounded bg-cover bg-center mb-2"
      style="background-image:url('https://images.unsplash.com/photo-1523381210434-271e8be1f52b')">
    </div>
    <p class="text-sm">Premium Cotton Hoodie â€“ Black</p>
  `;
  chat.appendChild(box);
  chat.scrollTop = chat.scrollHeight;
}

function typing() {
  const t = document.createElement("div");
  t.id = "typing";
  t.className = "self-start bg-white p-3 rounded-lg shadow-sm";
  t.innerHTML = `<div class="typing flex gap-1"><span>â€¢</span><span>â€¢</span><span>â€¢</span></div>`;
  chat.appendChild(t);
  chat.scrollTop = chat.scrollHeight;
}

function stopTyping() {
  const t = document.getElementById("typing");
  if (t) t.remove();
}

function expandIsland(text) {
  island.classList.add("island-expand");
  island.innerHTML = `<span class="material-symbols-outlined text-sm">shopping_bag</span>${text}`;
}

function resetIsland() {
  island.classList.remove("island-expand");
  island.innerHTML = `
    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
    Store Bot
  `;
}

function startDemo() {
  chat.innerHTML = "";
  resetIsland();

  setTimeout(()=>addMessage("Hi, do you have this hoodie in black size M?", "end"), 800);

  setTimeout(()=>typing(), 1600);

  setTimeout(()=>{
    stopTyping();
    expandIsland("Checking stock");
    addMessage("Yes! ðŸ˜Š We have size M in black. Would you like to see the product image?", "start");
  }, 2600);

  setTimeout(()=>resetIsland(), 4000);

  setTimeout(()=>{
    addMessage("Yes please", "end");
  }, 4600);

  setTimeout(()=>typing(), 5200);

  setTimeout(()=>{
    stopTyping();
    expandIsland("Sending product");
    addImageMessage("start");
  }, 6200);

  setTimeout(()=>{
    addMessage("Price is LKR 6,500. Free delivery within Colombo. Cash on Delivery available. Would you like to order?", "start");
  }, 7200);

  setTimeout(()=>resetIsland(), 8800);

  // LOOP
  setTimeout(startDemo, 12000);
}

startDemo();
</script>

</body>
</html>
